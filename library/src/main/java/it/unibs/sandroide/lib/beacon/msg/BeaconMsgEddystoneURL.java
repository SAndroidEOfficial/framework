/**
 * Copyright (c) 2016 University of Brescia, Alessandra Flammini, All rights reserved.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */

package it.unibs.sandroide.lib.beacon.msg;

import org.altbeacon.beacon.Beacon;
import org.altbeacon.beacon.BeaconParser;

import java.io.UnsupportedEncodingException;

public class BeaconMsgEddystoneURL extends BeaconMsgBase {

    public static String MSG_LAYOUT = BeaconParser.EDDYSTONE_URL_LAYOUT;
    //public static String MSG_LAYOUT = "s:0-1=feaa,m:2-2=10,p:3-3:-41,i:4-13,i:14-19"; //BeaconParser.EDDYSTONE_URL_LAYOUT;
    public static String MSG_SERVICEUUID = "feaa";
    public static String MSG_TYPECODE = "10";

    public String mUrl="";

    public BeaconMsgEddystoneURL(Beacon b) {
        super(b);
    }

    @Override
    public BeaconMsgBase parse() {
        if (!(this.MSG_SERVICEUUID.toUpperCase().equals(Long.toHexString(this.getServiceUuid()).toUpperCase()) &&
                this.MSG_TYPECODE.toUpperCase().equals(Long.toHexString(this.getBeaconTypeCode()).toUpperCase()))) {
            return null;
        }
        // Note: Here you can put your code to parse message data fields into convenient instance class variables
        try {
            mUrl = new String(this.getId1().toByteArray(), "UTF-8");
        } catch (UnsupportedEncodingException e) {
            e.printStackTrace();
        }
        return this;
    }

    @Override
    public String getImage() {
        return BASE64_IMAGE;
    }

    private static String BASE64_IMAGE = "iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoV2luZG93cykiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NTRBMjNCN0NFNkZGMTFFNjlCMTJDNjAwRjYyNThDNkQiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NTRBMjNCN0RFNkZGMTFFNjlCMTJDNjAwRjYyNThDNkQiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo1NEEyM0I3QUU2RkYxMUU2OUIxMkM2MDBGNjI1OEM2RCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo1NEEyM0I3QkU2RkYxMUU2OUIxMkM2MDBGNjI1OEM2RCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PrE8oZgAABfTSURBVHja7F1pjFvX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";

}
